# Инструкции по сборке расширения

## Автоматическая сборка

### Требования
- Python 3.6+

### Запуск сборки

#### Способ 1: Python скрипт
```bash
python build.py
```

#### Способ 2: Batch файл (Windows)
```bash
build.bat
```

### Результат
После успешной сборки будут созданы два ZIP архива:
- `DK-NEWS-HUNTERS-Chrome-v{версия}.zip` - для Chrome Web Store
- `DK-NEWS-HUNTERS-Firefox-v{версия}.zip` - для Firefox Add-ons

## Настройка исключений

Файлы и папки для исключения из сборки указываются в `.compile-ignore`:

```
# Файлы и папки, которые нужно исключить из сборки
.git
.gitignore
.compile-ignore
src
build.py
build.bat
README.md
DEBUG_GUIDE.md
TESTING_INSTRUCTIONS.md
BUILD_INSTRUCTIONS.md
*.md
.vscode
node_modules
.DS_Store
Thumbs.db
*.zip
build
dist

# Исключения для папки src (не копировать в итоговые архивы)
archive
```

### Универсальный подход к исключениям

Система поддерживает два уровня исключений:

1. **Корневой уровень** - исключает файлы и папки из общей сборки
2. **Уровень src/** - исключает файлы и папки внутри папки src из итоговых архивов

Это позволяет гибко настраивать, какие файлы попадут в финальные ZIP архивы расширения.

## Структура проекта

### Корневая папка (система сборки)
- `build.py` - основной скрипт сборки
- `build.bat` - batch файл для Windows
- `.compile-ignore` - файл исключений
- `BUILD_INSTRUCTIONS.md` - данная инструкция

### Папка src/ (исходный код расширения)
- `background.js` - фоновый скрипт
- `content.js` - скрипт контента
- `popup.html/js` - интерфейс popup
- `debug.html/js` - отладочные файлы
- `style.css` - стили
- `icons/` - иконки расширения
- `archive/` - манифесты для разных браузеров
  - `manifest.chrome.json` - манифест для Chrome
  - `manifest.firefox.json` - манифест для Firefox

## Различия между версиями

### Chrome (Manifest V3)
- Использует `service_worker` в фоновом режиме
- Поддерживает новые API Chrome Extensions

### Firefox (Manifest V3)
- Использует `scripts` в фоновом режиме
- Специфичные настройки для Firefox
- Поддержка `browser_specific_settings`

## Автоматическое определение версии

Версия автоматически извлекается из `archive/manifest.chrome.json` и добавляется к названию архивов.

## Устранение проблем

Если возникают ошибки при сборке:
1. Убедитесь, что Python установлен и доступен
2. Проверьте, что все манифесты находятся в папке `archive/`
3. Убедитесь, что у вас есть права на запись в текущую папку
4. При ошибках с временными файлами - перезапустите сборку
